import{u as P}from"./vue-clipboard3-abb1cd37.js";import{u as q,b as w}from"./vue-router-058388f3.js";import{_ as z}from"./index-951ade64.js";import{k as H,r as c,ag as h,o as s,c as r,a as o,Q as T,I as f,M as g,H as _,P as k,L as p,O as b}from"./@vue-330d97db.js";import"./clipboard-2fdbe17c.js";import"./aplayer-d80f7f58.js";import"./element-plus-acb27f52.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-df397a67.js";import"./@element-plus-4e918346.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-2cb15ffa.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-5ec34e26.js";import"./vue-cookies-191b1cbf.js";import"./@highlightjs-5c1784e4.js";import"./highlight.js-a76881e7.js";import"./axios-1f2f0c0e.js";import"./docx-preview-30c6d22b.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-021e3327.js";import"./vue-d736004e.js";import"./dplayer-ff9c2365.js";const j={class:"top"},F={class:"file-list"},Q=["onMouseenter","onMouseleave"],U=["title"],A={class:"op"},G=["onClick"],J=["onClick"],K={__name:"Share",setup(W){const{toClipboard:x}=P(),{proxy:l}=H();q(),w();const v={loadDataList:"/share/loadShareList",cancelShare:"/share/cancelShare"},C=c(document.location.origin+"/share/"),N=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],n=c({}),I={extHeight:20,selectType:"checkbox"},y=async()=>{let t={pageNo:n.value.pageNo,pageSize:n.value.pageSize};t.category!=="all"&&delete t.filePid;let a=await l.Request({url:v.loadDataList,params:t});a&&(n.value=a.data)},O=t=>{n.value.list.forEach(a=>{a.showOp=!1}),t.showOp=!0},L=t=>{t.showOp=!1},M=async t=>{await x(`链接:${C.value}${t.shareId} 提取码: ${t.code}`),l.Message.success("复制成功")},i=c([]),$=t=>{i.value=[],t.forEach(a=>{i.value.push(a.shareId)})},u=c([]),D=()=>{i.value.length!=0&&(u.value=i.value,S())},R=t=>{u.value=[t.shareId],S()},S=async()=>{l.Confirm("你确定要取消分享吗？",async()=>{await l.Request({url:v.cancelShare,params:{shareIds:u.value.join(",")}})&&(l.Message.success("取消分享成功"),y())})};return(t,a)=>{const B=h("el-button"),m=h("icon"),V=h("Table");return s(),r("div",null,[o("div",j,[T(B,{type:"primary",disabled:i.value.length==0,onClick:D},{default:f(()=>a[0]||(a[0]=[o("span",{class:"iconfont icon-cancel"},null,-1),g("取消分享 ")])),_:1},8,["disabled"])]),o("div",F,[T(V,{columns:N,showPagination:!0,dataSource:n.value,fetch:y,options:I,onRowSelected:$},{fileName:f(({index:E,row:e})=>[o("div",{class:"file-item",onMouseenter:d=>O(e),onMouseleave:d=>L(e)},[(e.fileType==3||e.fileType==1)&&e.status!==0?(s(),_(m,{key:0,cover:e.fileCover},null,8,["cover"])):(s(),r(k,{key:1},[e.folderType==0?(s(),_(m,{key:0,fileType:e.fileType},null,8,["fileType"])):p("",!0),e.folderType==1?(s(),_(m,{key:1,fileType:0})):p("",!0)],64)),e.showRename?p("",!0):(s(),r("span",{key:2,class:"file-name",title:e.fileName},[o("span",null,b(e.fileName),1)],8,U)),o("span",A,[e.showOp&&e.fileId?(s(),r(k,{key:0},[o("span",{class:"iconfont icon-link",onClick:d=>M(e)},"复制链接",8,G),o("span",{class:"iconfont icon-cancel",onClick:d=>R(e)},"取消分享",8,J)],64)):p("",!0)])],40,Q)]),expireTime:f(({index:E,row:e})=>[g(b(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])}}},xe=z(K,[["__scopeId","data-v-8dfc0301"]]);export{xe as default};
